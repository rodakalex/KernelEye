### Практическая задача по теории ядра Windows

**Задача**:  
Создать инструмент, который отслеживает создание новых процессов в системе, фиксирует их PID (Process ID), имя исполняемого файла и родительский процесс, а затем записывает эту информацию в текстовый лог-файл. 

### Требования:
1. Использовать Windows API для взаимодействия с ядром.
2. Логировать информацию о новых процессах в реальном времени.
3. Программа должна работать в пользовательском режиме (User Mode), но использовать системные вызовы для получения данных от ядра.
4. Обеспечить корректную обработку ошибок (например, недоступность доступа к системным объектам).
5. Лог должен содержать:
   - Время создания процесса.
   - PID нового процесса.
   - Имя исполняемого файла.
   - PID родительского процесса.

---

### Подсказки:
- Для мониторинга процессов можно использовать **функции Windows API**:
  - `OpenProcess` — для получения информации о процессе.
  - `QueryFullProcessImageName` — для получения полного пути исполняемого файла.
  - `GetProcessId` и `GetParentProcessId` (через `NtQueryInformationProcess`).
- Для отслеживания событий создания процессов можно использовать **ETW (Event Tracing for Windows)**.
- Информация о времени может быть получена с помощью `GetSystemTime` или аналогичных функций.

---

### Усложненный вариант:
1. Реализовать вывод статистики:
   - Количество процессов, созданных за последние 10 минут.
   - Какие процессы чаще всего запускаются.
2. Добавить возможность работы программы как службы Windows.

---

### Ожидаемый результат:
- Работающий инструмент, который в реальном времени фиксирует создание процессов и сохраняет эту информацию в лог-файл, например:
  ```
  [2024-12-15 15:34:23] Process Created: PID=1234, Name="notepad.exe", ParentPID=5678
  [2024-12-15 15:35:02] Process Created: PID=2345, Name="chrome.exe", ParentPID=1234
  ```

Такое задание поможет лучше понять взаимодействие между пользовательским режимом и ядром, а также познакомиться с важными аспектами безопасности и контроля системы.